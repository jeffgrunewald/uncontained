Kubernetes Setup

Log into the master to initiate the cluster
```
kubeadm init --pod-network-cidr=10.244.0.0/16 \
    --apiserver-advertise-address=$(ip a | grep -Eo "192\.168\.56\.[0-9]{1,3}" | head -1 \
    --kubernetes-version stable-1.9
```

Setup the client access
```
sudo cp /etc/kubernetes/admin.conf $HOME/ \
    && sudo chown $(id -u):$(id -g) $HOME/admin.conf \
    && export KUBECONFIG=$HOME/admin.conf \
    && echo "export KUBECONFIG=$HOME/admin.conf" | tee -a ~/.bashrc
```

Setup the overlay network
```
kubectl apply -f manifests/rbac.yaml \
    && kubectl apply -f manifests/canal.yaml
```

Log into the worker node and join it to the master with the token command generated by init'ing the master
```
kubeadm join --token token_id master_ip:6443 \
    --discovery-token-ca-cert-hash discovery_token_hash
```

Run yourself a simple pod
```
kubectl run guids --image=alexellis2/guid-service:latest --port 9000
```

Expose that pod with a service
```
kubectl expose deployment/guids
```

Scale that service
```
kubectl scale deployment/guids --replicas=3
```

Deploy from a manifest and browse to it from your laptop
```
kubectl apply -f manifests/ghost.yaml
```

Deploy a complicated, manifest-defined service with ingress rules
```
kubectl apply -f manifests/ingress/namespace.yaml

kubectl apply -f manifests/ingress/cafe-app.yaml

kubectl apply -f manifests/ingress/default-backend-deployment.yaml

kubectl apply -f manifests/ingress/default-backend-service.yaml

kubectl apply -f manifests/ingress/nginx-ingress-controller-roles.yaml

kubectl apply -f manifests/ingress/nginx-ingress-controller-config-map.yaml

kubectl apply -f manifests/ingress/nginx-ingress-controller-deployment.yaml

kubectl apply -f manifests/ingress/nginx-ingress-controller-service.yaml

kubectl apply -f manifests/ingress/nginx-ingress.yaml

kubectl apply -f manifests/ingress/cafe-ingress.yaml
```